<div class="trip-show-container">
    <div class="my-trip-show-head trip-title d-flex justify-content-center flex-column">
        <h3> <%= @trip.trip_name %> </h3>
        <h5><%= @trip.duration %> days</h5>
    </div>

    <div class="trip-show-header">
      <%= link_to user_path(@trip.user) do %>
        <div class="photo-container-small">
          <%= cl_image_tag(@trip.user.photo.url) %>
        </div>
      <% end %>
      <h5> <%= @trip.user.username %> | </h5>
      <h5> <%= @trip.created_at.day %>/<%= @trip.created_at.month %>/<%= @trip.created_at.year %> | </h5>
      <%= link_to trip_map_trip_path(@trip) do %>
        <i class="fas fa-map-marked-alt"></i>
      <% end %>
    </div>

  <% @trip.trip_duration.each do |day| %>
    <% if @shortlisted_activities.where(day: day).first.nil? %>
      <div class="day-container day-container-opacity mt-3" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(<%= asset_path 'trip_photo.jpg' %>)">
        <a data-toggle="collapse" href="#collapseExample<%= day %>" role="button" aria-expanded="false" aria-controls="collapseExample">
          <h4>Day <%= day %></h4>
          <h6>Nothing planned!
          <h6>click to add</h6>
        </a>
      </div>
    <% else %>
      <% @activity = @shortlisted_activities.where(day: day).first.activity.photo %>
      <div class="day-container mt-3" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= @activity %>')">
        <a data-toggle="collapse" href="#collapseExample<%= day %>" role="button" aria-expanded="false" aria-controls="collapseExample">
          <h4>Day <%= day %></h4>
          <h6>click to expand</h6>
        </a>
      </div>
    <% end %>

    <% tod_activity_picker(@shortlisted_activities, day).each_with_index do |activity, i| %>
      <% if activity.nil?  %>
        <div class="collapse" id="collapseExample<%= day %>">
          <div class="card-product background-gray">
            <div class="photo-img-container">
              <%= link_to (image_tag "add_photo.png"), new_trip_shortlisted_activity_path(@trip, day: day, index: i) %>
            </div>
            <div class="card-product-infos">
              <h3>No activity picked!</h3>
              <p>Add your own <strong>adventure</strong>!</p>
            </div>
          </div>
        </div>
        <% else %>
        <div class="collapse" id="collapseExample<%= day %>">
          <div class="card-product">
            <%= cl_image_tag activity.activity.photo %>
            <div class="card-product-infos">
              <h4><%= link_to activity.activity.name, trip_shortlisted_activity_path(@trip, activity) %></h4>
              <div class="icon-container">
                <div class="icon-inner-container d-flex">
                  <% activity.activity.categories.each do |category| %>
                    <div class="icon-name-container">
                      <i class="<%= category.icon %>"></i>
                      <p><%= category.name %></p>
                    </div>
                  <% end %>
                </div>
                  <div class="tod-icon">
                    <%= image_tag(tod_icon_picker(activity)) %>
                  </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  <% end %>
  <div class="all-container">
    <div class="trip-user-section">


      <% if @trip.user != current_user %>
        <div class="boxrow user-link">
          <div class="map-link-container">
            <p><%= link_to "View #{@trip.user.username}'s profile", trip_path(@trip) %></p>
          </div>
          <i class="fas fa-chevron-right"></i>
        </div>
      <% end %>
    </div>


    <% if @trip.user != current_user %>
      <div class="button-row">
        <%= link_to like_trip_path(@trip), method: :post, remote: true do %>
          <div>
            <button class="btn btn-warning triplikes"><%= @trip.likes %> <i class="fas fa-heart"></i></button>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>

